# Патч языка для Company of Heroes 2

В Company of Heroes 2 есть странная особенность: при запуске игры возможность переключить язык пропадает. Данный патч исправляет это.

# Установка
## 1 способ (автоматический)
1. Скачайте [PatchLoader.ps1](https://github.com/kotanys/Coh2LanguagePatch/blob/main/PatchLoader.ps1)
2. Перенесите PatchLoader.ps1 в папку с игрой (туда, где находится RelicCoH2.exe)
   - Папку с игрой можно найти, нажав правой кнопкой по игре в библиотеке Steam -> *Управление* -> *Просмотреть локальные файлы*
3. Запустите PatchLoader.ps1
   - Предварительно нужно разрешить выполнение скриптов PowerShell командой `Set-ExecutionPolicy -Scope CurrentUser Unrestricted` в терминале PowerShell.
   - Возможно, скрипт потребует установить модуль "Ps2exe". Это нужно разрешить
   - Для выполнения скрипта нужно подключение к интернету (скачивается _patch.ps1 с github)

Повторный запуск PatchLoader.ps1 переустановит патч.

После выполнения скрипта можно для безопасности снова запретить выполнение скриптов командой `Set-ExecutionPolicy -Scope CurrentUser Restricted`.

## 2 способ (ручной)
1. Скачайте [_patch.ps1](https://github.com/kotanys/Coh2LanguagePatch/blob/main/_patch.ps1)
2. Установите модуль Ps2exe командой `Install-Module Ps2exe`
3. Переименуйте исполняемый файл RelicCoH2.exe в любое другое имя, например - __RelicCoH2.exe
4. Откройте _patch.ps1 любым редактором и замените `{0}` в первой строке новым названием исполняемого файла CoH
5. Скомпилируйте _patch.ps1 в .exe - это делается командой `Invoke-ps2exe -inputFile _patch.ps1 -outputFile RelicCoH2.exe -Verbose -noConsole`
6. Переместите новый RelicCoH2.exe в папку с игрой.

# Удаление
Удалите RelicCoH2.exe и переименуйте исполняемый файл игры (при автоматической установке __RelicCoH2.exe) обратно в RelicCoH2.exe.
# Возможные проблемы
Исполняемые файлы, созданные с помощью Ps2exe, [иногда определяются антивирусами как небезопасные](https://github.com/MScholtes/Win-PS2EXE/issues/4#issuecomment-694711083). Это происходит потому, чтоскомпилированные скрипты PowerShell выглядят подозрительно для антивирусов (так как, например, они обходят политику исполнения скриптов). В случае возникновения этой проблемы стоит добавить созданный исполняемый файл в "белый список" антивируса.

Файлы с github скачиваются в кодировке UTF-8, из-за чего кириллица не выводится. Чтобы правильно видеть сообщения скрипта, нужно пересохранить файл в кодировке Windows-1251.